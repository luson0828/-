import{v as D,x as $,a as J,b as m,d as l,w as n,r as s,g as u,h as y,z as M,A as O,E as r,C as V,o as P}from"./index-D41mdhcm.js";import{r as p}from"./request-Hp9FWL9u.js";const R={class:"card"},j={class:"card"},I={class:"card"},T={class:"card"},F={class:"dialog-footer"},L={__name:"Admin",setup(G){const e=D({tableData:[],name:null,pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},ids:{},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],no:[{required:!0,message:"请输入工号",trigger:"blur"}]}}),c=$(null),d=()=>{p.get("/admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(a=>{e.tableData=a.data.list,e.total=a.data.total})};d();const C=()=>{e.name=null,d()},v=()=>{e.formVisible=!0,e.form={}},k=()=>{c.value.validate(a=>{a&&(e.form.id?w():x())})},z=a=>{e.form=JSON.parse(JSON.stringify(a)),e.formVisible=!0},x=()=>{p.post("/admin/add",e.form).then(a=>{a.code==="200"?(e.formVisible=!1,r.success("新增操作成功啦")):r.error(a.msg)})},w=()=>{p.put("/admin/update",e.form).then(a=>{a.code==="200"?(e.formVisible=!1,r.success("更新操作成功啦")):r.error(a.msg)})},S=a=>{V.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{p.delete("/admin/deleteById/"+a).then(t=>{t.code==="200"?(r.success("删除操作成功啦"),d()):r.error(t.msg)})}).catch(()=>{r.info("已取消删除操作")})},h=a=>{e.ids=a.map(t=>t.id)},N=()=>{if(e.ids.length===0){r.warning("请选择数据");return}V.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{p.delete("/admin/deleteBatch",{data:e.ids}).then(a=>{a.code==="200"?(r.success("删除操作成功啦"),d()):r.error(a.msg)})}).catch(()=>{r.info("已取消删除操作")})};return(a,t)=>{const g=s("el-input"),i=s("el-button"),_=s("el-card"),f=s("el-table-column"),B=s("el-table"),U=s("el-pagination"),b=s("el-form-item"),q=s("el-form"),E=s("el-dialog");return P(),J("div",null,[m("div",R,[l(_,null,{default:n(()=>[l(g,{style:{width:"240px"},modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.name=o),placeholder:"请输入搜索内容","prefix-icon":"Search"},null,8,["modelValue"]),l(i,{onClick:d,type:"primary",style:{"margin-left":"5px"}},{default:n(()=>t[7]||(t[7]=[u("查 询",-1)])),_:1,__:[7]}),l(i,{onClick:C,type:"warning",style:{"margin-left":"5px"}},{default:n(()=>t[8]||(t[8]=[u("重 置",-1)])),_:1,__:[8]})]),_:1})]),m("div",j,[l(_,null,{default:n(()=>[l(i,{type:"primary",style:{"margin-left":"5px"},onClick:v},{default:n(()=>t[9]||(t[9]=[u("新 增",-1)])),_:1,__:[9]}),l(i,{type:"warning",style:{"margin-left":"5px"},onClick:N},{default:n(()=>t[10]||(t[10]=[u("批量删除",-1)])),_:1,__:[10]})]),_:1})]),m("div",I,[l(B,{data:e.tableData,stripe:"",onSelectionChange:h},{default:n(()=>[l(f,{type:"selection",width:"55"}),l(f,{prop:"username",label:"账号"}),l(f,{prop:"name",label:"名称"}),l(f,{label:"操作"},{default:n(o=>[l(i,{onClick:A=>z(o.row),type:"primary",icon:y(M),circle:""},null,8,["onClick","icon"]),l(i,{onClick:A=>S(o.row.id),type:"danger",icon:y(O),circle:""},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"])]),m("div",T,[l(U,{onSizeChange:d,onCurrentChange:d,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=o=>e.pageNum=o),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=o=>e.pageSize=o),"page-sizes":[5,10,15,20],size:a.size,background:a.background,layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","size","background","total"])]),m("div",null,[l(E,{modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=o=>e.formVisible=o),title:"信息管理员",width:"500","destroy-on-close":""},{footer:n(()=>[m("div",F,[l(i,{onClick:t[5]||(t[5]=o=>e.formVisible=!1)},{default:n(()=>t[11]||(t[11]=[u("取 消",-1)])),_:1,__:[11]}),l(i,{type:"primary",onClick:k},{default:n(()=>t[12]||(t[12]=[u("保 存",-1)])),_:1,__:[12]})])]),default:n(()=>[l(q,{ref_key:"formRef",ref:c,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"40px","padding-top":"20px"}},{default:n(()=>[l(b,{label:"账号",prop:"username"},{default:n(()=>[l(g,{modelValue:e.form.username,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.username=o),autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),l(b,{label:"名称",prop:"name"},{default:n(()=>[l(g,{modelValue:e.form.name,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.name=o),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])])}}};export{L as default};
