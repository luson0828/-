import{v as q,x as A,a as J,b as m,d as o,w as a,r as i,g as p,h as b,z as M,A as O,E as s,C as y,o as P}from"./index-D41mdhcm.js";import{r as u}from"./request-Hp9FWL9u.js";const R={class:"card"},j={class:"card"},I={class:"card"},T={class:"card"},F={class:"dialog-footer"},L={__name:"Department",setup(G){const e=q({tableData:[],name:null,pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},ids:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}),c=A(null),r=()=>{u.get("/department/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(l=>{e.tableData=l.data.list,e.total=l.data.total})};r();const V=()=>{e.name=null,r()},C=()=>{console.log("点击了新增按钮"),e.formVisible=!0,console.log("当前 formVisible 值：",e.formVisible),e.form={}},v=()=>{c.value.validate(l=>{l&&(e.form.id?x():z())})},k=l=>{e.form=JSON.parse(JSON.stringify(l)),e.formVisible=!0},z=()=>{u.post("/department/add",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("新增操作成功啦"),r()):s.error(l.msg)})},x=()=>{u.put("/department/update",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("更新操作成功啦"),r()):s.error(l.msg)})},w=l=>{y.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{u.delete("/department/deleteById/"+l).then(t=>{t.code==="200"?(s.success("删除操作成功啦"),r()):s.error(t.msg)})}).catch(()=>{s.info("已取消删除操作")})},h=l=>{console.log(l),e.ids=l.map(t=>t.id),console.log(e.ids)},S=()=>{if(e.ids.length===0){s.warning("请选择数据");return}y.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{u.delete("/department/deleteBatch",{data:e.ids}).then(l=>{l.code==="200"?(s.success("删除操作成功啦"),r()):s.error(l.msg)})}).catch(()=>{s.info("已取消删除操作")})};return(l,t)=>{const g=i("el-input"),d=i("el-button"),_=i("el-card"),f=i("el-table-column"),N=i("el-table"),B=i("el-pagination"),U=i("el-form-item"),D=i("el-form"),E=i("el-dialog");return P(),J("div",null,[m("div",R,[o(_,null,{default:a(()=>[o(g,{style:{width:"240px"},modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=n=>e.name=n),placeholder:"请输入名称查询","prefix-icon":"Search"},null,8,["modelValue"]),o(d,{onClick:r,type:"primary",style:{"margin-left":"5px"}},{default:a(()=>t[6]||(t[6]=[p("查 询",-1)])),_:1,__:[6]}),o(d,{onClick:V,type:"warning",style:{"margin-left":"5px"}},{default:a(()=>t[7]||(t[7]=[p("重 置",-1)])),_:1,__:[7]})]),_:1})]),m("div",j,[o(_,null,{default:a(()=>[o(d,{type:"primary",style:{"margin-left":"5px"},onClick:C},{default:a(()=>t[8]||(t[8]=[p("新 增",-1)])),_:1,__:[8]}),o(d,{type:"warning",style:{"margin-left":"5px"},onClick:S},{default:a(()=>t[9]||(t[9]=[p("批量删除",-1)])),_:1,__:[9]})]),_:1})]),m("div",I,[o(N,{data:e.tableData,stripe:"",onSelectionChange:h},{default:a(()=>[o(f,{type:"selection",width:"55"}),o(f,{prop:"name",label:"名称"}),o(f,{label:"操作",width:"120"},{default:a(n=>[o(d,{onClick:$=>k(n.row),type:"primary",icon:b(M),circle:""},null,8,["onClick","icon"]),o(d,{onClick:$=>w(n.row.id),type:"danger",icon:b(O),circle:""},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"])]),m("div",T,[o(B,{onSizeChange:r,onCurrentChange:r,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=n=>e.pageNum=n),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=n=>e.pageSize=n),"page-sizes":[5,10,15,20],size:l.size,background:l.background,layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","size","background","total"])]),m("div",null,[o(E,{modelValue:e.formVisible,"onUpdate:modelValue":t[5]||(t[5]=n=>e.formVisible=n),title:"部门信息",width:"500","destroy-on-close":""},{footer:a(()=>[m("div",F,[o(d,{onClick:t[4]||(t[4]=n=>e.formVisible=!1)},{default:a(()=>t[10]||(t[10]=[p("取 消",-1)])),_:1,__:[10]}),o(d,{type:"primary",onClick:v},{default:a(()=>t[11]||(t[11]=[p("保 存",-1)])),_:1,__:[11]})])]),default:a(()=>[o(D,{ref_key:"formRef",ref:c,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"40px","padding-top":"20px"}},{default:a(()=>[o(U,{label:"名称",prop:"name"},{default:a(()=>[o(g,{modelValue:e.form.name,"onUpdate:modelValue":t[3]||(t[3]=n=>e.form.name=n),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])])}}};export{L as default};
