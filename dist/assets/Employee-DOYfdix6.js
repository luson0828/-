import{v as Q,x as C,q as W,y as X,a as b,b as f,d as t,w as a,r,g as i,f as Y,h as z,z as Z,A as ee,F as le,B as te,E as s,C as S,o as g,e as oe}from"./index-D41mdhcm.js";import{r as c}from"./request-Hp9FWL9u.js";const ae={class:"card"},ne={class:"card"},re={class:"card"},se=["src"],de={class:"card"},ie={class:"dialog-footer"},fe={__name:"Employee",setup(pe){const U=X(),l=Q({tableData:[],name:null,pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},ids:{},departments:[],rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],no:[{required:!0,message:"请输入工号",trigger:"blur"}]}}),N=C("http://localhost:8080/files/upload"),h=()=>{s.success("批量导入数据成功"),p()},B=()=>{window.open("http://localhost:8080/employee/export")},q=n=>{l.form.avatar=n.data},y=C(null),p=()=>{c.get("/employee/selectPage",{params:{pageNum:l.pageNum,pageSize:l.pageSize,name:l.name}}).then(n=>{l.tableData=n.data.list,l.total=n.data.total})},V=()=>{c.get("/department/selectAll").then(n=>{l.departments=n.data})};p();const D=()=>{l.name=null,p()},v=()=>{l.formVisible=!0,l.form={},V()},E=()=>{y.value.validate(n=>{n&&(l.form.id?M():I())})},A=n=>{l.form=JSON.parse(JSON.stringify(n)),l.formVisible=!0,V()},I=()=>{c.post("/employee/add",l.form).then(n=>{n.code==="200"?(l.formVisible=!1,s.success("新增操作成功啦"),p()):s.error(n.msg)})},M=()=>{c.put("/employee/update",l.form).then(n=>{n.code==="200"?(l.formVisible=!1,s.success("更新操作成功啦"),p()):s.error(n.msg)})},R=n=>{S.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{c.delete("/employee/deleteById/"+n).then(e=>{e.code==="200"?(s.success("删除操作成功啦"),p()):s.error(e.msg)})}).catch(()=>{s.info("已取消删除操作")})},$=n=>{l.ids=n.map(e=>e.id)},F=()=>{if(l.ids.length===0){s.warning("请选择数据");return}S.confirm("删除后无法恢复，确认删除吗？","确认删除",{type:"warning"}).then(()=>{c.delete("/employee/deleteBatch",{data:l.ids}).then(n=>{n.code==="200"?(s.success("删除操作成功啦"),p()):s.error(n.msg)})}).catch(()=>{s.info("已取消删除操作")})};return W(()=>{U.query.action==="add"&&v()}),(n,e)=>{const _=r("el-input"),d=r("el-button"),x=r("el-card"),w=r("el-upload"),u=r("el-table-column"),J=r("el-table"),O=r("el-pagination"),m=r("el-form-item"),k=r("el-radio"),P=r("el-radio-group"),j=r("el-input-number"),L=r("el-option"),T=r("el-select"),G=r("el-form"),H=r("el-dialog");return g(),b("div",null,[f("div",ae,[t(x,null,{default:a(()=>[t(_,{style:{width:"240px"},modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=o=>l.name=o),placeholder:"请输入名称查询","prefix-icon":"Search"},null,8,["modelValue"]),t(d,{onClick:p,type:"primary",style:{"margin-left":"5px"}},{default:a(()=>e[12]||(e[12]=[i("查 询",-1)])),_:1,__:[12]}),t(d,{onClick:D,type:"warning",style:{"margin-left":"5px"}},{default:a(()=>e[13]||(e[13]=[i("重 置",-1)])),_:1,__:[13]})]),_:1})]),f("div",ne,[t(x,null,{default:a(()=>[t(d,{type:"primary",style:{"margin-left":"5px"},onClick:v},{default:a(()=>e[14]||(e[14]=[i("新 增",-1)])),_:1,__:[14]}),t(d,{type:"warning",style:{"margin-left":"10px"},onClick:F},{default:a(()=>e[15]||(e[15]=[i("批量删除",-1)])),_:1,__:[15]}),t(w,{style:{display:"inline-block",margin:"0 5px"},action:"http://localhost:8080/employee/import","show-file-list":!1,"on-success":h},{default:a(()=>[t(d,{type:"success",style:{"margin-left":"5px"}},{default:a(()=>e[16]||(e[16]=[i("导 入",-1)])),_:1,__:[16]})]),_:1}),t(d,{onClick:B,type:"info",style:{"margin-left":"5px"}},{default:a(()=>e[17]||(e[17]=[i("导 出",-1)])),_:1,__:[17]})]),_:1})]),f("div",re,[t(J,{data:l.tableData,stripe:"",onSelectionChange:$},{default:a(()=>[t(u,{type:"selection",width:"55"}),t(u,{prop:"username",label:"账号"}),t(u,{label:"头像"},{default:a(o=>[o.row.avatar?(g(),b("img",{key:0,src:o.row.avatar,style:{width:"40px",height:"40px","border-radius":"50%"}},null,8,se)):Y("",!0)]),_:1}),t(u,{prop:"name",label:"名称"}),t(u,{prop:"sex",label:"姓别"}),t(u,{prop:"no",label:"工号"}),t(u,{prop:"age",label:"年龄"}),t(u,{prop:"description",label:"个人介绍","show-overflow-tooltip":""}),t(u,{prop:"departmentName",label:"部门"}),t(u,{label:"操作"},{default:a(o=>[t(d,{onClick:K=>A(o.row),type:"primary",icon:z(Z),circle:""},null,8,["onClick","icon"]),t(d,{onClick:K=>R(o.row.id),type:"danger",icon:z(ee),circle:""},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"])]),f("div",de,[t(O,{onSizeChange:p,onCurrentChange:p,"current-page":l.pageNum,"onUpdate:currentPage":e[1]||(e[1]=o=>l.pageNum=o),"page-size":l.pageSize,"onUpdate:pageSize":e[2]||(e[2]=o=>l.pageSize=o),"page-sizes":[5,10,15,20],size:n.size,background:n.background,layout:"total, sizes, prev, pager, next, jumper",total:l.total},null,8,["current-page","page-size","size","background","total"])]),f("div",null,[t(H,{modelValue:l.formVisible,"onUpdate:modelValue":e[11]||(e[11]=o=>l.formVisible=o),title:"员工信息",width:"500","destroy-on-close":""},{footer:a(()=>[f("div",ie,[t(d,{onClick:e[10]||(e[10]=o=>l.formVisible=!1)},{default:a(()=>e[21]||(e[21]=[i("取 消",-1)])),_:1,__:[21]}),t(d,{type:"primary",onClick:E},{default:a(()=>e[22]||(e[22]=[i("保 存",-1)])),_:1,__:[22]})])]),default:a(()=>[t(G,{ref_key:"formRef",ref:y,rules:l.rules,model:l.form,"label-width":"80px",style:{"padding-right":"40px","padding-top":"20px"}},{default:a(()=>[t(m,{label:"账号",prop:"username"},{default:a(()=>[t(_,{modelValue:l.form.username,"onUpdate:modelValue":e[3]||(e[3]=o=>l.form.username=o),autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),t(m,{label:"头像"},{default:a(()=>[t(w,{action:N.value,"list-type":"picture","on-success":q},{default:a(()=>[t(d,{type:"primary"},{default:a(()=>e[18]||(e[18]=[i("点击上传",-1)])),_:1,__:[18]})]),_:1},8,["action"])]),_:1}),t(m,{label:"名称",prop:"name"},{default:a(()=>[t(_,{modelValue:l.form.name,"onUpdate:modelValue":e[4]||(e[4]=o=>l.form.name=o),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"性别"},{default:a(()=>[t(P,{modelValue:l.form.sex,"onUpdate:modelValue":e[5]||(e[5]=o=>l.form.sex=o)},{default:a(()=>[t(k,{label:"男",value:"男"},{default:a(()=>e[19]||(e[19]=[i("男",-1)])),_:1,__:[19]}),t(k,{label:"女",value:"女"},{default:a(()=>e[20]||(e[20]=[i("女",-1)])),_:1,__:[20]})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"工号",prop:"no"},{default:a(()=>[t(_,{modelValue:l.form.no,"onUpdate:modelValue":e[6]||(e[6]=o=>l.form.no=o),autocomplete:"off",placeholder:"请输入工号"},null,8,["modelValue"])]),_:1}),t(m,{label:"年龄"},{default:a(()=>[t(j,{style:{width:"180px"},min:18,max:35,modelValue:l.form.age,"onUpdate:modelValue":e[7]||(e[7]=o=>l.form.age=o),autocomplete:"off",placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1}),t(m,{label:"部门"},{default:a(()=>[t(T,{modelValue:l.form.departmentId,"onUpdate:modelValue":e[8]||(e[8]=o=>l.form.departmentId=o),placeholder:"请选择部门",style:{width:"100%"}},{default:a(()=>[(g(!0),b(le,null,te(l.departments,o=>(g(),oe(L,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"个人介绍"},{default:a(()=>[t(_,{row:4,type:"textarea",modelValue:l.form.description,"onUpdate:modelValue":e[9]||(e[9]=o=>l.form.description=o),autocomplete:"off",placeholder:"请输入个人介绍"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])])}}};export{fe as default};
