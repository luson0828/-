import{v as c,x as _,a as g,d as r,b as x,w as l,r as a,g as P,o as V,E as p}from"./index-D41mdhcm.js";import{r as v}from"./request-Hp9FWL9u.js";const b={class:"card1",style:{padding:"40px 20px"}},y={style:{"text-align":"center"}},q={__name:"Password",setup(h){const u=(d,o,s)=>{o?o!==e.form.newPassword?s(new Error("两次输入密码不一致")):s():s(new Error("请再次确认新密码"))},e=c({user:JSON.parse(localStorage.getItem("xm-pro-user")),form:{},rules:{password:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{validator:u,trigger:"blur"}]}}),n=_(),f=()=>{e.form.id=e.user.id,e.form.role=e.user.role,n.value.validate(d=>{d&&v.put("/updatePassword",e.form).then(o=>{o.code==="200"?(p.success("修改成功"),localStorage.removeItem("xm-pro-user"),setTimeout(()=>{location.href="/login"},500)):p.error(o.msg)})})};return(d,o)=>{const s=a("el-input"),m=a("el-form-item"),i=a("el-form"),w=a("el-button");return V(),g("div",b,[r(i,{ref_key:"formRef",ref:n,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"40px","padding-top":"20px"}},{default:l(()=>[r(m,{label:"旧密码",prop:"password"},{default:l(()=>[r(s,{"show-password":"",modelValue:e.form.password,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.password=t),autocomplete:"off",placeholder:"请输入旧密码"},null,8,["modelValue"])]),_:1}),r(m,{label:"新密码",prop:"newPassword"},{default:l(()=>[r(s,{"show-password":"",modelValue:e.form.newPassword,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.newPassword=t),autocomplete:"off",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),r(m,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[r(s,{"show-password":"",modelValue:e.form.confirmPassword,"onUpdate:modelValue":o[2]||(o[2]=t=>e.form.confirmPassword=t),autocomplete:"off",placeholder:"请再次输入确认新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),x("div",y,[r(w,{type:"primary",onClick:f,style:{padding:"20px 30px"}},{default:l(()=>o[3]||(o[3]=[P("立即修改",-1)])),_:1,__:[3]})])])}}};export{q as default};
